sort(unique(Health_Storm_Data$EVTYPE))
Subset_Storm_Data$PROPVAL <- Subset_Storm_Data$PROPDMG * Subset_Storm_Data$PROPDMGEXP
Subset_Storm_Data$CROPVAL <- Subset_Storm_Data$CROPDMG * Subset_Storm_Data$CROPDMGEXP
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPVAL), TotCrop = sum(CROPVAL))
Economic_Storm_Data <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp, -Health_Storm_Data$TotCrop),]
Economic_Storm_Data[1:6,]
TopProp <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp), ][1:6, c('EVTYPE', 'TotProp')]
TopCrop <- Economic_Storm_Data[order(-Economic_Storm_Data$TotCrop), ][1:6, c('EVTYPE', 'TotCrop')]
TopCrop
class(Subset_Storm_Data$PROPDMG)
class(Subset_Storm_Data$PROPDMG)
Economic_Storm_Data[Economic_Storm_Data$EVTYPE == "HURRICANE",]
rm(list = ls())
setwd("/Users/abheebrahmnalkar/Desktop/datasciencecoursera/RR")
if(!file.exists("./RR-P2")){dir.create("./RR-P2")
setwd("/Users/abheebrahmnalkar/Desktop/datasciencecoursera/RR/RR-P2")
fileUrl <- "http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
download.file(fileUrl, destfile = "./repdata-data-StormData.csv.bz2", method = 'curl')
print("Created directory, downloaded and unzipped files")
}
if(file.exists("./RR-P2")) {
setwd("/Users/abheebrahmnalkar/Desktop/datasciencecoursera/RR/RR-P2")
if(!file.exists("repdata-data-StormData.csv.bz2")) {
fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
download.file(fileUrl, destfile = "./repdata-data-StormData.csv.bz2", method = "curl")
print("File had to be downloaded again")
}
}
# Read the file if it's not already read
if(!exists("Storm_Data")){
Storm_Data <- read.csv("repdata-data-StormData.csv.bz2", header = TRUE)
}
#SUBSETTING THE DATA
Subset_Storm_Data <- Storm_Data[, c("EVTYPE", "FATALITIES", "INJURIES", "PROPDMG", "PROPDMGEXP", "CROPDMG", "CROPDMGEXP")]
#Change the case
## change class to character so the below loop works
Subset_Storm_Data$EVTYPE <- as.character(Subset_Storm_Data$EVTYPE)
#loop
Subset_Storm_Data <- data.frame(lapply(Subset_Storm_Data, function(v) {
if (is.character(v)) return(toupper(v))
else return(v)
}))
## Apply ddply on fatalities and injuries.
library(plyr)
Health_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, Totfat = sum(FATALITIES), Totinj = sum(INJURIES))
Subset_Storm_Data$EVTYPE <- gsub(".*TSTM.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM WIND.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUDERSTORM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDEERSTORM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERESTORM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM  WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM W INDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM WINS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMS WIND.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMS WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMW.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMW 50.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMW WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORMWINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTROM WIND.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTROM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERTORM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERTSORM WIND.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDESTORM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNERSTORM WINDS.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM DAMAGE.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM DAMAGE TO.*", "TSTM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSTORM HAIL.*", "TSTM", Subset_Storm_Data$EVTYPE) # HAIL MIGHT HAVE BIGGER IMPACT ON CROP DAMAGE. STILL CLUBBING IT UNDER THUNDERSTORM.
Subset_Storm_Data$EVTYPE <- gsub(".*WINDS.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WND.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".* WIND.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND CHILL/HIGH WIND.*", "WIND CHILL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTER STORM HIGH WINDS.*", "WINTER STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTER STORM/HIGH WIND.*", "WINTER STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTER STORM/HIGH WINDS.*", "WINTER STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTER STORMS.*", "WINTER STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTER WEATHER MIX.*", "WINTER WEATHER", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTER WEATHER/MIX.*", "WINTER WEATHER", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTERY MIX.*", "WINTER WEATHER", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WINTRY MIX.*", "WINTER WEATHER", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*AVALANCE.*", "AVALANCHE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".* COASTAL FLOOD.*", "BEACH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".* FLASH FLOOD.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD/.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD/ FLOOD.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD/FLOOD.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD/ STREET.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOODING.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD FLASH.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD/FLASH.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD FLOOD/FLASH.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD/FLASH FLOOD.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD/FLASH FLOODING.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD/FLASH/FLOOD.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD/FLASHFLOOD.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*DRY MICROBURST.*", "DRY MICROBURST", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD - HEAVY RAIN.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD FROM ICE JAMS.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOD LANDSLIDES.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOODS.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLASH FLOOODING.*", "FLASH FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*DUST DEVEL.*", "DUST DEVIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*DUST DEVIL WATERSPOUT.*", "DUST DEVIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*DUSTSTORM.*", "DUST STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BEACH EROSIN.*", "BEACH EROSION", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BEACH EROSION/COASTAL FLOOD.*", "BEACH EROSION", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BEACH FLOOD.*", "BEACH EROSION", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BLIZZARD SUMMARY.*", "BLIZZARD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BLIZZARD AND HEAVY SNOW.*", "BLIZZARD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BLIZZARD WEATHER.*", "BLIZZARD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BLIZZARD/FREEZING RAIN.*", "BLIZZARD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BLIZZARD/HEAVY SNOW.*", "BLIZZARD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BLIZZARD/WINTER STORM.*", "BLIZZARD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*BRUSH FIRES.*", "BRUSH FIRE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTAL  FLOODING/EROSION.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTAL EROSION.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTAL FLOODING.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTAL FLOODING/EROSION.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTAL/TIDAL FLOOD.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTALFLOOD.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*COASTALSTORM.*", "COASTAL STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*CSTL FLOODING/EROSION.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*DAM BREAK.*", "DAM FAILURE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*DROUGHT/EXCESSIVE HEAT.*", "DROUGHT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*EXCESSIVE HEAT/DROUGHT.*", "DROUGHT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*EROSION/CSTL FLOOD.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*EROSION/CSTL FLOOD.*", "COASTAL FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*EXTREME COLD/WIND CHILL.*", "EXTREME COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*EXTREME/RECORD COLD.*", "EXTREME COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD & HEAVY RAIN.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOODING.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOODING/HEAVY RAIN.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOOD/RAIN/WIND.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FLOODS.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FOG AND COLD TEMPERATURES.*", "FOG", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FREEZING DRIZZLE AND FREEZING.*", "FREEZING DRIZZLE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FREEZING RAIN.*", "FREEZING DRIZZLE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FREEZING RAIN SLEET AND.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FREEZING RAIN SLEET AND LIGHT.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FREEZING RAIN/SLEET.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FREEZING RAIN/SNOW.*", "FREEZING RAIN AND SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FROST/FREEZE.*", "FROST", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FROST\\FREEZE.*", "FROST", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FUNNEL CLOUD..*", "FUNNEL CLOUD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FUNNEL CLOUDS.*", "FUNNEL CLOUD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FUNNEL CLOUD/HAIL.*", "FUNNEL CLOUD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*FUNNELS.*", "FUNNEL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*GLAZE ICE.*", "GLAZE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*GLAZE/ICE STORM.*", "GLAZE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*GUSTNADO AND.*", "GUSTANDO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 0.75.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 0.88.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 075.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 088.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 1.00.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 1.75.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 1.75).*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 100.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 125.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 150.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 175.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 200.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 225.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 275.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 450.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 75.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 80.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL 88.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL(0.75).*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL/ICY ROADS.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL/WIND.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL STORM.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL DAMAGE.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HAIL ALOFT.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LATE SEASON HAIL.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAT DROUGHT.*", "HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAT WAVE.*", "HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAT WAVE DROUGHT.*", "HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAT WAVES.*", "HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAT/DROUGHT.*", "HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEATBURST.*", "HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY PRECIPATATION.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY PRECIPITATION.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN AND FLOOD.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN EFFECTS.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/HIGH SURF.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/LIGHTNING.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/MUDSLIDES/FLOOD.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/SEVERE WEATHER.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/SMALL STREAM URBAN.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/SNOW.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/URBAN FLOOD.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAIN/WIND.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAINFALL.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY RAINS.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SHOWER.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SHOWERS.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HVY RAIN.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW & ICE.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW AND.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW AND ICE.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW AND ICE STORM.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW ANDBLOWING SNOW.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW SHOWER.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW SQUALLS.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW-SQUALLS.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/BLIZZARD.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/BLIZZARD/AVALANCHE.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/BLOWING SNOW.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/HIGH.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/ICE.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/ICE STORM.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/SLEET.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/SQUALLS.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/WIND.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOW/WINTER STORM.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SNOWPACK.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY WET SNOW.*", "HEAVY SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SURF/HIGH SURF.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HEAVY SWELLS.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HIGH  SWELLS.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HIGH SURF.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HIGH SURF ADVISORIES.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HIGH SURF ADVISORY.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HIGH SWELLS.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HIGH WAVES.*", "HEAVY SURF", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICE AND SNOW.*", "ICE", Subset_Storm_Data$EVTYPE)
#Subset_Storm_Data$EVTYPE <- gsub(".*ICE JAM FLOOD (MINOR.*", "ICE JAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICE PELLETS.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICE ON ROAD.*", "ICE ROADS", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICY ROADS.*", "ICE ROADS", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICE AND SNOW.*", "ICE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICE STORM AND SNOW.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICE STORM/FLASH FLOOD.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ICESTORM/BLIZZARD.*", "FREEZING RAIN AND SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LANDSLIDE/URBAN FLOOD.*", "LANDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LANDSLIDES.*", "LANDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LATE-SEASON SNOWFALL.*", "LATE SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTING.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING..*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING AND HEAVY RAIN.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING AND HEAVY RAIN.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING  WAUSEON.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING DAMAGE.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING FIRE.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGNTNING.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LIGHTNING/HEAVY RAIN.*", "LIGHTNING", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LOCALLY HEAVY RAIN.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*LOCAL FLOOD.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MAJOR FLOOD.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MINOR FLOOD.*", "FLOOD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MARINE MISHAP.*", "MARINE ACCIDENT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MIXED PRECIP.*", "MIXED PRECIPITATION", Subset_Storm_Data$EVTYPE)
#RUNNING OUT OF PATIENCE. ONLY OBVIOUS SPELLING MISTAKES NOW ON...
Subset_Storm_Data$EVTYPE <- gsub(".*MONTHLY RAINFALL.*", "MIXED PRECIPITATION", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MUD SLIDE.*", "MUDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MUD SLIDES.*", "MUDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MUD/ROCK SLIDE.*", "MUDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MUDSLIDE/LANDSLIDE.*", "MUDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*MUDSLIDES.*", "MUDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*ROCK SLIDE.*", "MUDSLIDE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RAIN (HEAVY).*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RAIN/SNOW.*", "RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RAIN/WIND.*", "RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RAINSTORM.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD  COLD.*", "RECORD COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD COLD/FROST.*", "RECORD COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD COOL.*", "RECORD COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD SNOW/COLD.*", "RECORD SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD DRY MONTH.*", "RECORD DRYNESS", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD HEAT WAVE.*", "RECORD HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD/EXCESSIVE HEAT.*", "RECORD HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD HIGH TEMPERATURE.*", "RECORD HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD TEMPERATURE.*", "RECORD HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD TEMPERATURES.*", "RECORD HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD WARM TEMPS..*", "RECORD WARM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD WARMTH.*", "RECORD WARM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*RECORD WINTER SNOW.*", "RECORD SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SLEET STORM.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SLEET/ICE STORM.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SLEET/RAIN/SNOW.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SLEET/SNOW.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SMALL HAIL.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SMALL STREAM AND.*", "SMALL STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SMALL STREAM AND URBAN FLOOD.*", "SMALL STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SMALL STREAM/URBAN FLOOD.*", "SMALL STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SML STREAM FLD.*", "SMALL STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW SQUALLS.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW SQUALL.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW ADVISORY.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW AND COLD.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW AND HEAVY SNOW.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW AND ICE.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW AND ICE STORM.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW AND SLEET.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW SHOWERS.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW SLEET.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/ BITTER COLD.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/ ICE.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/BLOWING SNOW.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/COLD.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/HEAVY SNOW.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/ICE.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/ICE STORM.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/RAIN.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/RAIN/SLEET.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/SLEET.*", "SLEET", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW/SLEET/RAIN.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOW\\COLD.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*SNOWFALL RECORD.*", "RECORD SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*STORM SURGE/TIDE.*", "STORM SURGE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TEMPERATURE RECORD.*", "RECORD HEAT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSNOW.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*THUNDERSNOW SHOWER.*", "SNOW", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADO DEBRIS.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADO F0.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADO F1.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADO F2.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADO F3.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADO/WATERSPOUT.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADOES.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNADOS.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORNDAO.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORRENTIAL RAIN.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TORRENTIAL RAINFALL.*", "HEAVY RAIN", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TROPICAL STORM ALBERTO.*", "TROPICAL STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TROPICAL STORM DEAN.*", "TROPICAL STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TROPICAL STORM GORDON.*", "TROPICAL STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*TROPICAL STORM JERRY.*", "TROPICAL STORM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*UNSEASONABLY COLD.*", "UNSEASONABLE COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*UNSEASONABLY COOL.*", "UNSEASONABLE COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*UNSEASONABLY COOL & WET.*", "UNSEASONABLE COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*UNUSUALLY COLD.*", "UNSEASONABLE COLD", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN SMALL.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN SMALL STREAM FLOOD.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SMALL.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SMALL STREAM.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SMALL STREAM  FLOOD.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SMALL STREAM FLOOD.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SMALL STRM FLDG.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SML STREAM FLD.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*URBAN/SML STREAM FLDG.*", "URBAN STREAM", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*VOLCANIC ASH PLUME.*", "VOLCANIC ASH", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*VOLCANIC ASHFALL.*", "VOLCANIC ASH", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATER SPOUT.*", "WATERSPOUT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUT FUNNEL CLOUD.*", "WATERSPOUT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUT TORNADO.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUTS.*", "WATERSPOUT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WAYTERSPOUT.*", "WATERSPOUT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUT-TORNADO.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUT/TORNADO.*", "TORNADO", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUT-.*", "WATERSPOUT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WATERSPOUT/.*", "WATERSPOUT", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WILD FIRES.*", "WILD FIRE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WILD/FOREST FIRE.*", "WILD FIRE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WILD/FOREST FIRES.*", "WILD FIRE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WILDFIRE.*", "WILD FIRE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WILDFIRES.*", "WILD FIRE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND ADVISORY.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND AND WAVE.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND CHILL.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND DAMAGE.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND GUSTS.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND STORM.*", "WIND", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*WIND/HAIL.*", "HAIL", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE EDOUARD.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE EMILY.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE ERIN.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE FELIX.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE GORDON.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE OPAL.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE OPAL/HIGH WINDS.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE-GENERATED SWELLS.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Subset_Storm_Data$EVTYPE <- gsub(".*HURRICANE/TYPHOON.*", "HURRICANE", Subset_Storm_Data$EVTYPE)
Health_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, Totfat = sum(FATALITIES), Totinj = sum(INJURIES))
Health_Storm_Data <- Health_Storm_Data[order(-Health_Storm_Data$Totfat, -Health_Storm_Data$Totinj),]
Health_Storm_Data[1:6,]
TopHurters <- Health_Storm_Data[order(-Health_Storm_Data$Totinj), ][1:6, c('EVTYPE', 'Totinj')]
TopKillers <- Health_Storm_Data[order(-Health_Storm_Data$Totfat), ][1:6, c('EVTYPE', 'Totfat')]
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot(TopKillers$Totfat, las = 2, names.arg = TopKillers$EVTYPE, main = "Events with Highest Fatalities", ylab = "Number of fatalities", col = "light blue")
barplot((TopHurters$Totinj/1000), las = 2, names.arg = TopKillers$EVTYPE, main = "Events with Highest Injuries", ylab = "Number of people injuried (in thousands)", col = "light yellow")
unique(Storm_Data$CROPDMGEXP)
unique(Storm_Data$PROPDMGEXP)
Subset_Storm_Data$CROPDMGEXP <- as.character(Subset_Storm_Data$CROPDMGEXP)
Subset_Storm_Data$PROPDMGEXP <- as.character(Subset_Storm_Data$PROPDMGEXP)
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == ""] <- 1
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "0"] <- 1
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "?"] <- 0
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "2"] <- 100
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "B"] <- 1000000000
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "K"] <- 1000
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "k"] <- 1000
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "m"] <- 1000000
Subset_Storm_Data$CROPDMGEXP[Subset_Storm_Data$CROPDMGEXP == "M"] <- 1000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "-"] <- 1
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "?"] <- 0
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "0"] <- 1
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "1"] <- 10
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "2"] <- 100
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "3"] <- 1000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "4"] <- 10000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "5"] <- 100000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "6"] <- 1000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "7"] <- 10000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "8"] <- 100000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "B"] <- 1000000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "h"] <- 100
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "H"] <- 100
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "K"] <- 1000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "m"] <- 1000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "M"] <- 1000000
Subset_Storm_Data$PROPDMGEXP[Subset_Storm_Data$PROPDMGEXP == "+"] <- 1
Subset_Storm_Data$CROPDMGEXP <- as.numeric(Subset_Storm_Data$CROPDMGEXP)
Subset_Storm_Data$PROPDMGEXP <- as.numeric(Subset_Storm_Data$PROPDMGEXP)
Subset_Storm_Data$PROPVAL <- Subset_Storm_Data$PROPDMG * Subset_Storm_Data$PROPDMGEXP
Subset_Storm_Data$CROPVAL <- Subset_Storm_Data$CROPDMG * Subset_Storm_Data$CROPDMGEXP
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPVAL), TotCrop = sum(CROPVAL))
Economic_Storm_Data <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp, -Economic_Storm_Data$TotCrop),]
Economic_Storm_Data[1:6,]
Economic_Storm_Data[Economic_Storm_Data$EVTYPE == "HURRICANE",]
Subset_Storm_Data[Subset_Storm_Data$EVTYPE == "HURRICANE",]
Subset_Storm_Data$PROPVAL <- Subset_Storm_Data$PROPDMG * Subset_Storm_Data$PROPDMGEXP
Subset_Storm_Data$CROPVAL <- Subset_Storm_Data$CROPDMG * Subset_Storm_Data$CROPDMGEXP
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPVAL), TotCrop = sum(CROPVAL), na.rm = T)
Economic_Storm_Data <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp, -Economic_Storm_Data$TotCrop),]
Economic_Storm_Data[1:6,]
Economic_Storm_Data[Economic_Storm_Data$EVTYPE == "HURRICANE",]
sum(Subset_Storm_Data$PROPVAL[Subset_Storm_Data$EVTYPE == "HURRICANE",])
Subset_Storm_Data$PROPVAL[Subset_Storm_Data$EVTYPE == "HURRICANE",]
Subset_Storm_Data$PROPVAL[Subset_Storm_Data$EVTYPE == "HURRICANE"]
sum(Subset_Storm_Data$PROPVAL[Subset_Storm_Data$EVTYPE == "HURRICANE"])
sum(Subset_Storm_Data$PROPVAL[Subset_Storm_Data$EVTYPE == "HURRICANE"], na.rm = T)
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPDMG*PROPDMGEXP, na.rm = T), TotCrop = sum(CROPDMG*CROPDMGEXP, na.rm = T))
TopProp <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp), ][1:6, c('EVTYPE', 'TotProp')]
TopCrop <- Economic_Storm_Data[order(-Economic_Storm_Data$TotCrop), ][1:6, c('EVTYPE', 'TotCrop')]
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Millions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPDMG*PROPDMGEXP, na.rm = T), TotCrop = sum(CROPDMG*CROPDMGEXP, na.rm = T))
TopProp <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp), ][1:6, c('EVTYPE', 'TotProp')]
TopCrop <- Economic_Storm_Data[order(-Economic_Storm_Data$TotCrop), ][1:6, c('EVTYPE', 'TotCrop')]
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Billions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPDMG*PROPDMGEXP, na.rm = T), TotCrop = sum(CROPDMG*CROPDMGEXP, na.rm = T), TotLoss = sum(TotProp, TotCrop, na.rm = T))
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPDMG*PROPDMGEXP, na.rm = T), TotCrop = sum(CROPDMG*CROPDMGEXP, na.rm = T), TotLoss = sum(TotProp, TotCrop, na.rm = T))
TopProp <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp), ][1:6, c('EVTYPE', 'TotProp')]
TopCrop <- Economic_Storm_Data[order(-Economic_Storm_Data$TotCrop), ][1:6, c('EVTYPE', 'TotCrop')]
TopLoss <- Economic_Storm_Data[order(-Economic_Storm_Data$TotLoss), ][1:6, c('EVTYPE', 'TotCrop')]
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Billions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most devastating weather events", ylab = "$ Amount in Billions", col = "light blue")
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPDMG*PROPDMGEXP, na.rm = T), TotCrop = sum(CROPDMG*CROPDMGEXP, na.rm = T), TotLoss = sum(TotProp, TotCrop, na.rm = T))
TopProp <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp), ][1:6, c('EVTYPE', 'TotProp')]
TopCrop <- Economic_Storm_Data[order(-Economic_Storm_Data$TotCrop), ][1:6, c('EVTYPE', 'TotCrop')]
TopLoss <- Economic_Storm_Data[order(-Economic_Storm_Data$TotLoss), ][1:6, c('EVTYPE', 'TotLoss')]
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Billions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most Devastating Events", ylab = "$ Amount in Billions", col = "light blue")
Economic_Storm_Data <- ddply(Subset_Storm_Data, "EVTYPE", summarize, TotProp = sum(PROPDMG*PROPDMGEXP, na.rm = T), TotCrop = sum(CROPDMG*CROPDMGEXP, na.rm = T), TotLoss = sum(TotProp, TotCrop, na.rm = T))
TopProp <- Economic_Storm_Data[order(-Economic_Storm_Data$TotProp), ][1:6, c('EVTYPE', 'TotProp')]
TopCrop <- Economic_Storm_Data[order(-Economic_Storm_Data$TotCrop), ][1:6, c('EVTYPE', 'TotCrop')]
TopLoss <- Economic_Storm_Data[order(-Economic_Storm_Data$TotLoss), ][1:10, c('EVTYPE', 'TotLoss')]
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Billions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most Devastating Events", ylab = "$ Amount in Billions", col = "light blue")
par(mfrow=c(2,3))
for (i in 1:5){
x = rnorm(100)
y = .5*x + rnorm(100, 0, sqrt(1-.5^2))
plot(x,y)
}
> MyLayOut <- matrix(c(2, 0, 1, 3), nrow = 2, ncol=2, byrow = TRUE)
> nf <- layout(mat = MyLayOut, widths = c(3, 1), heights = c(1, 3),
respect = TRUE)
> xrange <- c(min(Benthic$NAP), max(Benthic$NAP))
> yrange <- c(min(Benthic$Richness), max(Benthic$Richness))
> #First graph
> par(mar = c(4, 4, 2, 2))
> plot(Benthic$NAP, Benthic$Richness, xlim = xrange, ylim = yrange,
xlab = "NAP", ylab = "Richness")
> #Second graph
> par(mar = c(0, 3, 1, 1))
> boxplot(Benthic$NAP, horizontal = TRUE, axes = FALSE, frame.plot =
FALSE, ylim = xrange, space = 0) > #Third graph
> par(mar = c(3, 0, 1, 1))
> boxplot(Benthic$Richness, axes = FALSE, ylim = yrange, space = 0,
horiz = TRUE)
MyLayOut <- matrix(c(2, 0, 1, 3), nrow = 2, ncol=2, byrow = TRUE) nf <- layout(mat = MyLayOut, widths = c(3, 1), heights = c(1, 3),              respect = TRUE) xrange <- c(min(Benthic$NAP), max(Benthic$NAP)) yrange <- c(min(Benthic$Richness), max(Benthic$Richness)) #First graph par(mar = c(4, 4, 2, 2)) plot(Benthic$NAP, Benthic$Richness, xlim = xrange, ylim = yrange,      xlab = "NAP", ylab = "Richness") #Second graph par(mar = c(0, 3, 1, 1)) boxplot(Benthic$NAP, horizontal = TRUE, axes = FALSE, frame.plot =             FALSE, ylim = xrange, space = 0)  #Third graph par(mar = c(3, 0, 1, 1)) boxplot(Benthic$Richness, axes = FALSE, ylim = yrange, space = 0,         horiz = TRUE)
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most Devastating Events", ylab = "$ Amount in Billions", col = "light blue", fig.align='center')
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot(TopKillers$Totfat, las = 2, names.arg = TopKillers$EVTYPE, main = "Events with Highest Fatalities", ylab = "Number of fatalities", col = "light blue")
barplot((TopHurters$Totinj/1000), las = 2, names.arg = TopKillers$EVTYPE, main = "Events with Highest Injuries", ylab = "Number of people injuried (in thousands)", col = "light yellow")
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Billions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most Devastating Events", ylab = "$ Amount in Billions", col = "light blue")
#par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot(TopKillers$Totfat, las = 2, names.arg = TopKillers$EVTYPE, main = "Events with Highest Fatalities", ylab = "Number of fatalities", col = "light blue")
barplot((TopHurters$Totinj/1000), las = 2, names.arg = TopKillers$EVTYPE, main = "Events with Highest Injuries", ylab = "Number of people injuried (in thousands)", col = "light yellow")
par(mfrow = c(1, 2), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopProp$TotProp/1000000000), las = 2, names.arg = TopProp$EVTYPE, main = "Events with Highest Property Damage", ylab = "$ Amount in Billions", col = "orange")
barplot((TopCrop$TotCrop/1000000000), las = 2, names.arg = TopCrop$EVTYPE, main = "Events with Crop Damage", ylab = "$ Amount in Billions", col = "light green")
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most Devastating Events", ylab = "$ Amount in Billions", col = "light blue")
par(mfrow = c(1, 1), mar = c(12, 5, 3, 2), mgp = c(3, 1, 0), cex = 0.8, oma = c(0,0,0,0))
barplot((TopLoss$TotLoss/1000000000), las = 2, names.arg = TopLoss$EVTYPE, main = "Most Devastating Events", ylab = "$ Amount in Billions", col = "light blue")
